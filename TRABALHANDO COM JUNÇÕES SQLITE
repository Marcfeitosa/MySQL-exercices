-- TRABALHANDO COM JUNÇÕES - ENTENDENDO INNER JOINS
-- SELECIONA OS PEDIDOS, STATUS, o ID DO CLIENTE, A CIDADE E O ESTADO A PARTIR DAS TABELAS ORDERS E CUSTOMERS

SELECT ORDER_ID
      ,PEDIDO.ORDER_STATUS
      ,CLIENTE.CUSTOMER_ID
      ,CLIENTE.CUSTOMER_CITY
      ,CLIENTE.CUSTOMER_STATE
FROM ORDERS PEDIDO INNER JOIN CUSTOMERS CLIENTE
ON PEDIDO.CUSTOMER_ID = CLIENTE.CUSTOMER_ID

-- SELECIONANDO DADOS DAS TABELAS DE PEDIDOS, PAGAMENTOS E ITENS

SELECT PEDIDOS.ORDER_ID AS ID_PEDIDO
      ,PRODUTOS.PRODUCT_ID AS ID_PRODUTO
      ,PRODUTOS.PRODUCT_CATEGORY_NAME AS CATEGORIA_PRODUTO
      ,PRODUTOS.PRODUCT_PHOTOS_QTY AS QTD_FOTOS_PRODUTO
      ,ITENS.PRICE AS PREÇO
      ,PAGAMENTOS.PAYMENT_TYPE AS TIPO_PAGAMENTO
      ,PAGAMENTOS.PAYMENT_VALUE AS VALOR_PAGAMENTO
FROM ORDER_ITEMS ITENS INNER JOIN PRODUCTS PRODUTOS
ON ITENS.PRODUCT_ID = PRODUTOS.PRODUCT_ID

INNER JOIN ORDERS PEDIDOS
ON PEDIDOS.ORDER_ID = ITENS.ORDER_ID

INNER JOIN ORDER_PAYMENTS PAGAMENTOS
ON PAGAMENTOS.ORDER_ID = PEDIDOS.ORDER_ID

-- USANDO O WHERE PARA FILTRAR

SELECT PEDIDOS.ORDER_ID AS ID_PEDIDO
      ,PRODUTOS.PRODUCT_ID AS ID_PRODUTO
      ,PRODUTOS.PRODUCT_CATEGORY_NAME AS CATEGORIA_PRODUTO
      ,PRODUTOS.PRODUCT_PHOTOS_QTY AS QTD_FOTOS_PRODUTO
      ,ITENS.PRICE AS PREÇO
      ,PAGAMENTOS.PAYMENT_TYPE AS TIPO_PAGAMENTO
      ,PAGAMENTOS.PAYMENT_VALUE AS VALOR_PAGAMENTO
FROM ORDER_ITEMS ITENS INNER JOIN PRODUCTS PRODUTOS
ON ITENS.PRODUCT_ID = PRODUTOS.PRODUCT_ID

INNER JOIN ORDERS PEDIDOS
ON PEDIDOS.ORDER_ID = ITENS.ORDER_ID

INNER JOIN ORDER_PAYMENTS PAGAMENTOS
ON PAGAMENTOS.ORDER_ID = PEDIDOS.ORDER_ID

WHERE PRODUTOS.PRODUCT_PHOTOS_QTY > 1



