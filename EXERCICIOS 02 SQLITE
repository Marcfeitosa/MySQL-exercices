-- EXERCÍCIO 02

-- 1. CONTE A QUANTIDADE DE PEDIDOS E AGRUPE POR CIDADE (UTILIZE AS TABELAS ORDERS E CUSTOMERS)

SELECT CIDADE.CUSTOMER_CITY AS CIDADE
      ,SUM(ORDER_ID) AS SOMA_DE_PEDIDOS
FROM ORDERS PEDIDOS INNER JOIN CUSTOMERS CIDADE
ON PEDIDOS.CUSTOMER_ID = CIDADE.CUSTOMER_ID
GROUP BY CIDADE.CUSTOMER_CITY


-- 2. SELECIONE O ID DO PEDIDO, O STATUS, O ID DO CLIENTE, A CIDADE DO CLIENTE E O ESTADO MESMO QUE ESTE NÃO ESTEJA PRESENTE NA TABELA CUSTOMER.

SELECT PEDIDO.ORDER_ID AS ID_PEDIDO
      ,PEDIDO.ORDER_STATUS AS STATUS_PEDIDO
      ,CLIENTE.CUSTOMER_ID AS ID_CLIENTE
      ,CLIENTE.CUSTOMER_CITY AS CIDADE_CLIENTE
      ,CLIENTE.CUSTOMER_STATE AS ESTADO_CLIENTE
FROM ORDERS PEDIDO INNER JOIN CUSTOMERS CLIENTE
ON PEDIDO.CUSTOMER_ID = CLIENTE.CUSTOMER_ID



-- 3. SELECIONE O ID DO PEDIDO, A QUANTIDADE DE FOTOS, O PREÇO, O TIPO DE PAGAMENTO E O VALOR DE PAGAMENTO DOS PRODUTOS QUE TEM MAIS DE 3 FOTOS UTILIZE AS TABELAS: PEDIDOS, PAGAMENTOS E ITENS

SELECT PEDIDOS.ORDER_ID AS ID_PEDIDO
      ,PRODUTOS.PRODUCT_PHOTOS_QTY AS QTD_FOTOS_PRODUTO
      ,ITENS.PRICE AS PREÇO
      ,PAGAMENTOS.PAYMENT_TYPE AS TIPO_PAGAMENTO
      ,PAGAMENTOS.PAYMENT_VALUE AS VALOR_PAGAMENTO
FROM ORDER_ITEMS ITENS INNER JOIN PRODUCTS PRODUTOS
ON ITENS.PRODUCT_ID = PRODUTOS.PRODUCT_ID

INNER JOIN ORDERS PEDIDOS
ON PEDIDOS.ORDER_ID = ITENS.ORDER_ID

INNER JOIN ORDER_PAYMENTS PAGAMENTOS
ON PAGAMENTOS.ORDER_ID = PEDIDOS.ORDER_ID